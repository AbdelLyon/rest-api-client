{"version":3,"file":"UpdateRelation.js","sources":["../../../../src/mutation/builder/UpdateRelation.ts"],"sourcesContent":["import type {\n   Attributes,\n   AttachRelationDefinition,\n   CreateRelationOperation,\n   CreateRelationParams,\n   DetachRelationDefinition,\n   IUpdateRelation,\n   SimpleKey,\n   SyncParams,\n   SyncRelationDefinition,\n   ToggleParams,\n   ToggleRelationDefinition,\n   UpdateRelationOperation,\n   UpdateRelationParams,\n   BaseRelationDefinition,\n} from \"../types\";\n\nexport class UpdateRelation implements IUpdateRelation {\n   public add<T extends Attributes, TRelationKey extends keyof T = never>(\n      params: CreateRelationParams<T, TRelationKey>,\n   ): CreateRelationOperation<T> {\n      const { attributes, relations } = params;\n\n      const relationDefinition: CreateRelationOperation<T> = {\n         operation: \"create\",\n         attributes,\n         ...(relations && { relations }),\n      };\n\n      this.defineRelationDefinition(relationDefinition);\n      return relationDefinition;\n   }\n\n   public edit<T extends Attributes, TRelationKey extends keyof T = never>(\n      params: UpdateRelationParams<T, TRelationKey>,\n   ): UpdateRelationOperation<T> {\n      const { key, attributes, relations } = params;\n\n      const relationDefinition: UpdateRelationOperation<T> = {\n         operation: \"update\",\n         key,\n         attributes,\n         ...(relations && { relations }),\n      };\n\n      this.defineRelationDefinition(relationDefinition);\n      return relationDefinition;\n   }\n\n   public attach(key: SimpleKey): AttachRelationDefinition {\n      const result: AttachRelationDefinition = {\n         operation: \"attach\",\n         key,\n      };\n\n      this.defineRelationDefinition(result);\n      return result;\n   }\n\n   public detach(key: SimpleKey): DetachRelationDefinition {\n      const result: DetachRelationDefinition = {\n         operation: \"detach\",\n         key,\n      };\n\n      this.defineRelationDefinition(result);\n      return result;\n   }\n\n   public sync<T>(params: SyncParams<T>): SyncRelationDefinition<T> {\n      const { key, attributes, pivot, withoutDetaching } = params;\n\n      const result: SyncRelationDefinition<T> = {\n         operation: \"sync\",\n         key,\n         without_detaching: withoutDetaching,\n         ...(attributes && { attributes }),\n         ...(pivot && { pivot }),\n      };\n\n      this.defineRelationDefinition(result);\n      return result;\n   }\n\n   public toggle<T>(params: ToggleParams<T>): ToggleRelationDefinition<T> {\n      const { key, attributes, pivot } = params;\n\n      const result: ToggleRelationDefinition<T> = {\n         operation: \"toggle\",\n         key,\n         ...(attributes && { attributes }),\n         ...(pivot && { pivot }),\n      };\n\n      this.defineRelationDefinition(result);\n      return result;\n   }\n\n   private defineRelationDefinition(result: BaseRelationDefinition): void {\n      Object.defineProperty(result, \"__relationDefinition\", {\n         value: true,\n         enumerable: false,\n         writable: false,\n         configurable: true,\n      });\n   }\n}"],"names":[],"mappings":"AAiBO,MAAM,eAA0C;AAAA,EAC7C,IACJ,QAC2B;AACrB,UAAA,EAAE,YAAY,UAAA,IAAc;AAElC,UAAM,qBAAiD;AAAA,MACpD,WAAW;AAAA,MACX;AAAA,MACA,GAAI,aAAa,EAAE,UAAU;AAAA,IAChC;AAEA,SAAK,yBAAyB,kBAAkB;AACzC,WAAA;AAAA,EAAA;AAAA,EAGH,KACJ,QAC2B;AAC3B,UAAM,EAAE,KAAK,YAAY,UAAc,IAAA;AAEvC,UAAM,qBAAiD;AAAA,MACpD,WAAW;AAAA,MACX;AAAA,MACA;AAAA,MACA,GAAI,aAAa,EAAE,UAAU;AAAA,IAChC;AAEA,SAAK,yBAAyB,kBAAkB;AACzC,WAAA;AAAA,EAAA;AAAA,EAGH,OAAO,KAA0C;AACrD,UAAM,SAAmC;AAAA,MACtC,WAAW;AAAA,MACX;AAAA,IACH;AAEA,SAAK,yBAAyB,MAAM;AAC7B,WAAA;AAAA,EAAA;AAAA,EAGH,OAAO,KAA0C;AACrD,UAAM,SAAmC;AAAA,MACtC,WAAW;AAAA,MACX;AAAA,IACH;AAEA,SAAK,yBAAyB,MAAM;AAC7B,WAAA;AAAA,EAAA;AAAA,EAGH,KAAQ,QAAkD;AAC9D,UAAM,EAAE,KAAK,YAAY,OAAO,iBAAqB,IAAA;AAErD,UAAM,SAAoC;AAAA,MACvC,WAAW;AAAA,MACX;AAAA,MACA,mBAAmB;AAAA,MACnB,GAAI,cAAc,EAAE,WAAW;AAAA,MAC/B,GAAI,SAAS,EAAE,MAAM;AAAA,IACxB;AAEA,SAAK,yBAAyB,MAAM;AAC7B,WAAA;AAAA,EAAA;AAAA,EAGH,OAAU,QAAsD;AACpE,UAAM,EAAE,KAAK,YAAY,MAAU,IAAA;AAEnC,UAAM,SAAsC;AAAA,MACzC,WAAW;AAAA,MACX;AAAA,MACA,GAAI,cAAc,EAAE,WAAW;AAAA,MAC/B,GAAI,SAAS,EAAE,MAAM;AAAA,IACxB;AAEA,SAAK,yBAAyB,MAAM;AAC7B,WAAA;AAAA,EAAA;AAAA,EAGF,yBAAyB,QAAsC;AAC7D,WAAA,eAAe,QAAQ,wBAAwB;AAAA,MACnD,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,cAAc;AAAA,IAAA,CAChB;AAAA,EAAA;AAEP;"}