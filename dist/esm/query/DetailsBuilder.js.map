{"version":3,"file":"DetailsBuilder.js","sources":["../../../src/query/DetailsBuilder.ts"],"sourcesContent":["import type { RequestConfig } from \"@/http/types\";\nimport type { DetailsResponse, IQuery } from \"./types\";\n\ntype ExtractKeys<T> = keyof T & string;\ntype ExtractRelationKeys<T> = {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  [K in keyof T]: T[K] extends Array<infer _>\n    ? K & string\n    : T[K] extends object\n      ? K & string\n      : never;\n}[keyof T] &\n  string;\n\nexport class DetailsBuilder<T> {\n  private queryInstance?: IQuery<T>;\n  private requestOptions: Partial<RequestConfig> = {};\n\n  constructor(queryInstance?: IQuery<T>) {\n    this.queryInstance = queryInstance;\n  }\n\n  public withHeaders(headers: Record<string, string>): this {\n    this.requestOptions.headers = {\n      ...this.requestOptions.headers,\n      ...headers,\n    };\n    return this;\n  }\n\n  public withHeader(name: string, value: string): this {\n    if (!this.requestOptions.headers) {\n      this.requestOptions.headers = {};\n    }\n    this.requestOptions.headers[name] = value;\n    return this;\n  }\n\n  public withTimeout(timeout: number): this {\n    this.requestOptions.timeout = timeout;\n    return this;\n  }\n\n  public withField<K extends ExtractKeys<T>>(field: K): this {\n    return this.withParam(\"fields\", field);\n  }\n\n  public withFields<K extends ExtractKeys<T>>(...fields: K[]): this {\n    return this.withParam(\"fields\", fields.join(\",\"));\n  }\n\n  public withInclude<K extends ExtractRelationKeys<T>>(relation: K): this {\n    return this.withParam(\"include\", relation);\n  }\n\n  public withIncludes<K extends ExtractRelationKeys<T>>(\n    ...relations: K[]\n  ): this {\n    return this.withParam(\"include\", relations.join(\",\"));\n  }\n\n  public withParams(params: Record<string, string | number | boolean>): this {\n    const stringParams: Record<string, string> = {};\n\n    Object.entries(params).forEach(([key, value]) => {\n      stringParams[key] = String(value);\n    });\n\n    this.requestOptions.params = {\n      ...this.requestOptions.params,\n      ...stringParams,\n    };\n    return this;\n  }\n\n  public withParam(key: string, value: string | number | boolean): this {\n    if (!this.requestOptions.params) {\n      this.requestOptions.params = {};\n    }\n    this.requestOptions.params[key] = String(value);\n    return this;\n  }\n\n  public withCredentials(credentials: RequestCredentials): this {\n    this.requestOptions.credentials = credentials;\n    return this;\n  }\n\n  public withSignal(signal: AbortSignal): this {\n    this.requestOptions.signal = signal;\n    return this;\n  }\n\n  public withResponseType(\n    type: \"json\" | \"text\" | \"blob\" | \"arraybuffer\",\n  ): this {\n    this.requestOptions.responseType = type;\n    return this;\n  }\n\n  public async details(): Promise<DetailsResponse> {\n    if (!this.queryInstance) {\n      throw new Error(\n        \"No query instance provided to execute the details request\",\n      );\n    }\n    return await this.queryInstance.details(this.build());\n  }\n\n  public build(): Partial<RequestConfig> {\n    return this.requestOptions;\n  }\n}\n"],"names":[],"mappings":";;;AAcO,MAAM,eAAkB;AAAA,EAI7B,YAAY,eAA2B;AAH/B;AACA,0CAAyC,CAAC;AAGhD,SAAK,gBAAgB;AAAA,EAAA;AAAA,EAGhB,YAAY,SAAuC;AACxD,SAAK,eAAe,UAAU;AAAA,MAC5B,GAAG,KAAK,eAAe;AAAA,MACvB,GAAG;AAAA,IACL;AACO,WAAA;AAAA,EAAA;AAAA,EAGF,WAAW,MAAc,OAAqB;AAC/C,QAAA,CAAC,KAAK,eAAe,SAAS;AAC3B,WAAA,eAAe,UAAU,CAAC;AAAA,IAAA;AAE5B,SAAA,eAAe,QAAQ,IAAI,IAAI;AAC7B,WAAA;AAAA,EAAA;AAAA,EAGF,YAAY,SAAuB;AACxC,SAAK,eAAe,UAAU;AACvB,WAAA;AAAA,EAAA;AAAA,EAGF,UAAoC,OAAgB;AAClD,WAAA,KAAK,UAAU,UAAU,KAAK;AAAA,EAAA;AAAA,EAGhC,cAAwC,QAAmB;AAChE,WAAO,KAAK,UAAU,UAAU,OAAO,KAAK,GAAG,CAAC;AAAA,EAAA;AAAA,EAG3C,YAA8C,UAAmB;AAC/D,WAAA,KAAK,UAAU,WAAW,QAAQ;AAAA,EAAA;AAAA,EAGpC,gBACF,WACG;AACN,WAAO,KAAK,UAAU,WAAW,UAAU,KAAK,GAAG,CAAC;AAAA,EAAA;AAAA,EAG/C,WAAW,QAAyD;AACzE,UAAM,eAAuC,CAAC;AAEvC,WAAA,QAAQ,MAAM,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAClC,mBAAA,GAAG,IAAI,OAAO,KAAK;AAAA,IAAA,CACjC;AAED,SAAK,eAAe,SAAS;AAAA,MAC3B,GAAG,KAAK,eAAe;AAAA,MACvB,GAAG;AAAA,IACL;AACO,WAAA;AAAA,EAAA;AAAA,EAGF,UAAU,KAAa,OAAwC;AAChE,QAAA,CAAC,KAAK,eAAe,QAAQ;AAC1B,WAAA,eAAe,SAAS,CAAC;AAAA,IAAA;AAEhC,SAAK,eAAe,OAAO,GAAG,IAAI,OAAO,KAAK;AACvC,WAAA;AAAA,EAAA;AAAA,EAGF,gBAAgB,aAAuC;AAC5D,SAAK,eAAe,cAAc;AAC3B,WAAA;AAAA,EAAA;AAAA,EAGF,WAAW,QAA2B;AAC3C,SAAK,eAAe,SAAS;AACtB,WAAA;AAAA,EAAA;AAAA,EAGF,iBACL,MACM;AACN,SAAK,eAAe,eAAe;AAC5B,WAAA;AAAA,EAAA;AAAA,EAGT,MAAa,UAAoC;AAC3C,QAAA,CAAC,KAAK,eAAe;AACvB,YAAM,IAAI;AAAA,QACR;AAAA,MACF;AAAA,IAAA;AAEF,WAAO,MAAM,KAAK,cAAc,QAAQ,KAAK,OAAO;AAAA,EAAA;AAAA,EAG/C,QAAgC;AACrC,WAAO,KAAK;AAAA,EAAA;AAEhB;"}